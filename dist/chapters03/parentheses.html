<!DOCTYPE html><html><head><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta charset="utf-8"><title>圆括号问题 - learn es6</title><meta name="description" content=""><meta name="author" content=""><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><link rel="stylesheet" href="../assets/css/bulma.min.css"><link rel="stylesheet" href="../assets/css/app.css"><!--[if lt IE 9]>
<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]--><link rel="shortcut icon" href=""></head><body dir="ltr"><nav class="columns navbar"><div class="column logo is-3 is-offset-1"><a class="is-brand" href="../index.html">learn es6</a></div></nav><div class="columns content"><div class="column is-2-desktop is-3-widescreen is-hidden-touch"></div><div class="column article-container is-11-tablet is-8-desktop is-6-widescreen"><div class="breadcrumb-area"><a href="../index.html" class="breadcrumb-item">Home</a><span class="breadcrumb-delimiter"> &gt; </span><a href="../chapters03/index.html" class="breadcrumb-item">第三章 变量的解构赋值</a><span class="breadcrumb-delimiter"> &gt; </span><a href="../chapters03/parentheses.html" class="breadcrumb-item">圆括号问题</a></div><h1 class="article-title">圆括号问题</h1><div class="article"><p><code>解构赋值</code>虽然很方便，但是<code>解析</code>起来并不容易。</p><p>对于<code>编译器</code>来说，一个<code>式子</code>到底是<code>模式</code>，还是<code>表达式</code>，没有办法从一开始就知道，必须<code>解析</code>到（或解析不到）<code>等号</code>才能知道。</p><p>由此带来的问题是，如果模式中出现<code>圆括号</code>怎么处理。<code>ES6</code> 的规则是，只要有可能导致<code>解构</code>的<code>歧义</code>，就不得使用<code>圆括号</code>。</p><p>但是，这条规则实际上不那么容易<code>辨别</code>，处理起来相当麻烦。因此，建议只要有可能，就不要在<code>模式</code>中放置<code>圆括号</code>。</p><h2 id="避免使用情况">避免使用情况 <a class="markdownIt-Anchor" href="#避免使用情况">#</a></h2><p>不能使用圆括号的情况</p><p>以下三种解构赋值不得使用圆括号。</p><h3 id="变量声明语句">变量声明语句 <a class="markdownIt-Anchor" href="#变量声明语句">#</a></h3><pre class="hljs"><code>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">log</span>) </span>{
    <span class="hljs-comment">// 全部报错</span>
    <span class="hljs-keyword">const</span> [(a)] = [<span class="hljs-number">1</span>];<span class="hljs-comment">// SyntaxError: Unexpected token (</span>

    <span class="hljs-keyword">const</span> {<span class="hljs-attr">x</span>: (c)} = {};<span class="hljs-comment">// SyntaxError: Unexpected token (</span>
    <span class="hljs-keyword">const</span> ({<span class="hljs-attr">x</span>: c}) = {};<span class="hljs-comment">// SyntaxError: Unexpected token (</span>
    <span class="hljs-keyword">const</span> {(x: c)} = {};<span class="hljs-comment">// SyntaxError: Unexpected token (</span>
    <span class="hljs-keyword">const</span> {(x): c} = {};<span class="hljs-comment">// SyntaxError: Unexpected token (</span>

    <span class="hljs-keyword">const</span> { <span class="hljs-attr">o</span>: ({ <span class="hljs-attr">p</span>: p }) } = { <span class="hljs-attr">o</span>: { <span class="hljs-attr">p</span>: <span class="hljs-number">2</span> } };<span class="hljs-comment">// SyntaxError: Unexpected token (</span>
})(<span class="hljs-built_in">console</span>.log)
</code></pre><p>上面 6 个语句都会报错，因为它们都是<code>变量</code>声明语句，<code>模式</code>不能使用<code>圆括号</code>。</p><hr><h3 id="函数参数">函数参数 <a class="markdownIt-Anchor" href="#函数参数">#</a></h3><p><code>函数参数</code>也属于<code>变量声明</code>，因此不能带有<code>圆括号</code>。</p><pre class="hljs"><code><span class="hljs-comment">// 报错</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">[(z</span>)]) </span>{ <span class="hljs-keyword">return</span> z; }<span class="hljs-comment">// SyntaxError: Unexpected token (</span>
<span class="hljs-comment">// 报错</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">[z,(x</span>)]) </span>{ <span class="hljs-keyword">return</span> x; }<span class="hljs-comment">// SyntaxError: Unexpected token (</span>
</code></pre><hr><h3 id="赋值语句的模式">赋值语句的模式 <a class="markdownIt-Anchor" href="#赋值语句的模式">#</a></h3><pre class="hljs"><code>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">log</span>) </span>{
    <span class="hljs-comment">// 全部报错</span>
    ({ <span class="hljs-attr">p</span>: a }) = { <span class="hljs-attr">p</span>: <span class="hljs-number">42</span> };<span class="hljs-comment">// SyntaxError: Unexpected token (</span>
    ([a]) = [<span class="hljs-number">5</span>];<span class="hljs-comment">// SyntaxError: Unexpected token (</span>
})(<span class="hljs-built_in">console</span>.log)
</code></pre><p>上面代码将整个<code>模式</code>放在<code>圆括号</code>之中，导致报错。</p><pre class="hljs"><code>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">log</span>) </span>{
    <span class="hljs-comment">// 报错</span>
    [({ <span class="hljs-attr">p</span>: a }), { <span class="hljs-attr">x</span>: c }] = [{}, {}];<span class="hljs-comment">// SyntaxError: Unexpected token (</span>
})(<span class="hljs-built_in">console</span>.log)
</code></pre><p>上面代码将一部分<code>模式</code>放在<code>圆括号</code>之中，导致报错。</p><hr><h2 id="可以使用情况">可以使用情况 <a class="markdownIt-Anchor" href="#可以使用情况">#</a></h2><p>可以使用<code>圆括号</code>的情况只有一种：<code>赋值语句</code>的<code>非模式</code>部分，可以使用<code>圆括号</code>。</p><pre class="hljs"><code>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">log</span>) </span>{
    [(b)] = [<span class="hljs-number">3</span>]; <span class="hljs-comment">// 正确</span>
    log(b);<span class="hljs-comment">// 3</span>
    ({ <span class="hljs-attr">p</span>: (d) } = {}); <span class="hljs-comment">// 正确</span>
    log(d);<span class="hljs-comment">// undefined</span>
    [(<span class="hljs-built_in">parseInt</span>.prop)] = [<span class="hljs-number">3</span>]; <span class="hljs-comment">// 正确</span>
    log(<span class="hljs-built_in">parseInt</span>.prop);<span class="hljs-comment">// 3</span>
})(<span class="hljs-built_in">console</span>.log)
</code></pre><p>上面三行语句都可以正确执行，因为首先它们都是<code>赋值</code>语句，而不是<code>声明</code>语句；</p><p>其次它们的<code>圆括号</code>都不属于<code>模式</code>的一部分。</p><p>第一行<code>语句</code>中，<code>模式</code>是取<code>数组</code>的第一个成员，跟<code>圆括号</code>无关；</p><p>第二行<code>语句</code>中，模式是<code>p</code>，而不是<code>d</code>；</p><p>第三行<code>语句</code>与第一行<code>语句</code>的<code>性质</code>一致。</p><p><code>解构赋值</code>允许等号左边的<code>模式</code>之中，不放置任何<code>变量名</code>。因此，可以写出<code>非常古怪</code>的<code>赋值表达式</code>。</p><pre class="hljs"><code>({} = [<span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>]);
({} = <span class="hljs-string">'abc'</span>);
({} = []);
</code></pre><p>上面的<code>表达式</code>虽然<code>毫无意义</code>，但是语法是<code>合法</code>的，可以执行。</p><hr></div><div dir="ltr" class="level article-bar is-mobile"><div class="level-item has-text-centered"><a title="previous page" class="previouse-article-link" href="../chapters03/complex.html"><span class="icon icon-previous" data-icon="previous"></span><span class="link-content">&laquo; Previous</span></a></div><div class="level-item has-text-centered"><a title="font size" class="link-item link-item-size"><span class="icon icon-size" data-icon="size"></span></a></div><div class="level-item has-text-centered"><a title="table of content" class="link-item link-item-toc"><span class="icon icon-toc" data-icon="toc"></span></a></div><div class="level-item has-text-centered"><a title="top" href="#"><span class="icon icon-up" data-icon="up"></span> <span class="link-content">⤊ Top</span></a></div><div class="level-item has-text-centered"><a title="next page" class="next-article-link" href="../chapters03/use.html"><span class="icon icon-next" data-icon="next"></span><span class="link-content">Next &raquo;</span></a></div></div></div><div class="column is-2-widescreen is-hidden"></div></div><div class="columns foot"><div class="column is-3 is-offset-9 build-by">Build by <a href="https://github.com/ruanyf/loppo" target="_blank">Loppo</a> 0.6.14</div></div><div class="book-toc notification is-warning is-hidden"><h3>Table of chapters &nbsp;<span class="title-close"><a class="button is-danger"> Close</a></span></h3><ul class="chapter-area"><li class="chapter-item"><a href="../chapters01/index.html">第一章 ECMAScript 6 简介</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-expand" data-icon="expand"></span></a></li><ul class="chapter-level-1"><li class="chapter-item"><a href="../chapters01/Babel.html">通过Babel使用ES6</a></li><li class="chapter-item"><a href="../chapters01/Traceur.html">通过Traceur使用ES6</a></li><li class="chapter-item"><a href="../chapters01/base.html">基础前置知识</a></li></ul><li class="chapter-item"><a href="../chapters02/index.html">第二章 let和const命令</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-expand" data-icon="expand"></span></a></li><ul class="chapter-level-1"><li class="chapter-item"><a href="../chapters02/base.html">前置知识了解</a></li><li class="chapter-item"><a href="../chapters02/const.html">const 命令</a></li><li class="chapter-item"><a href="../chapters02/let.html">let 命令</a></li></ul><li class="chapter-item"><a href="../chapters03/index.html">第三章 变量的解构赋值</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-collapse" data-icon="collapse"></span></a></li><ul class="chapter-level-1 chapter-level-1-current"><li class="chapter-item"><a href="../chapters03/base.html">基础数据结构</a></li><li class="chapter-item"><a href="../chapters03/complex.html">复杂数据结构</a></li><li class="chapter-item chapter-item-current"><a href="../chapters03/parentheses.html">圆括号问题</a></li><li class="chapter-item"><a href="../chapters03/use.html">用途</a></li></ul><li class="chapter-item"><a href="../chapters04/index.html">第四章 字符串的扩展</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-expand" data-icon="expand"></span></a></li><ul class="chapter-level-1"><li class="chapter-item"><a href="../chapters04/instance-function-extend.html">实例对象方法扩展</a></li><li class="chapter-item"><a href="../chapters04/prototype-function-extend.html">原型对象方法扩展</a></li><li class="chapter-item"><a href="../chapters04/string-Iterator.html">字符串的遍历器接口</a></li><li class="chapter-item"><a href="../chapters04/tag-template.html">标签模板</a></li><li class="chapter-item"><a href="../chapters04/template-string.html">模板字符串</a></li><li class="chapter-item"><a href="../chapters04/unicode.html">字符的 Unicode 表示法</a></li></ul></ul></div><div class="progress-indicator"></div><!-- SCRIPTS --><script>var LOPPO={current_path:"chapters03/parentheses.md",relative_root_path:"../",article_toc:'<ul class="markdownIt-TOC">\n<li><a href="#%E9%81%BF%E5%85%8D%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5">避免使用情况</a>\n<ul>\n<li><a href="#%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%E8%AF%AD%E5%8F%A5">变量声明语句</a></li>\n<li><a href="#%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0">函数参数</a></li>\n<li><a href="#%E8%B5%8B%E5%80%BC%E8%AF%AD%E5%8F%A5%E7%9A%84%E6%A8%A1%E5%BC%8F">赋值语句的模式</a></li>\n</ul>\n</li>\n<li><a href="#%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5">可以使用情况</a></li>\n</ul>\n'}</script><script src="../assets/js/app.js"></script></body></html>